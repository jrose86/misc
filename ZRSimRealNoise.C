// Add random HBT peak to noise from off-peak regions in the real data
// 20ns chunks for each

// general idea: read in (w for loop) each 20ns chunk OR each graph then 20ns chunks from graph (if statements for dif baselines)
// add random peak to all
// loop over - make amp dists etc graphs for all

void ZRSimRealNoise(){

  TRandom3* tr = new TRandom3();
  tr->SetSeed(0);

  gStyle->SetOptFit(1); //<== puts fit parameters in the stats box

  double TauWindowWidth = 20.0;
  const int npath = 231; // MUST be a constant for the array
  TCanvas* noisey = new TCanvas("","", 1200,900);
  //noisey->Divide(6,39);
  double Amp(2.0*pow(10,-6));
  double Sigma(4.0);
  double Shift(0.0);

  /*TF1* myGaus = new TF1("gausFit","[0]*exp(-pow((x-[1])/[2],2)/2.0)",-(Nbins/2)*binSize,(Nbins/2)*binSize);
  gausFit->SetParName(0,"Amp");         gausFit->SetParameter(0,0.0);
  gausFit->SetParName(1,"#tau_{0}");    gausFit->SetParLimits(1,-10,10);
  double SigmaMax(6.0),SigmaMin(3.0);
  gausFit->SetParName(2,"#sigma");      gausFit->SetParameter(2,4);   gausFit->SetParLimits(2,SigmaMin,SigmaMax);*/


  TString Dir[npath] = {"UTC20211217/m12d16h23/T0T1Nolan/",
                        "UTC20211217/m12d16h23/T1T2Nolan/",
                        "UTC20211217/m12d16h23/T1T2OFF/",
                        "UTC20211217/m12d16h23/T1T3Nolan/",
                        "UTC20211217/m12d16h23/T1T3OFF/",
                        "UTC20211217/m12d16h23/T1T4Nolan/",
                        "UTC20211217/m12d16h23/T1T4OFF/",
                        "UTC20211217/m12d16h23/T2T3Nolan/",
                        "UTC20211217/m12d16h23/T2T3OFF/",
                        "UTC20211217/m12d16h23/T2T4Nolan/",
                        "UTC20211217/m12d16h23/T2T4OFF/",
                        "UTC20211217/m12d16h23/T3T4Nolan/",
                        "UTC20211217/m12d16h23/T3T4OFF/",
                        "UTC20211217/m12d17h01/T0T1Nolan/",
                        "UTC20211217/m12d17h01/T1T2Nolan/",
                        "UTC20211217/m12d17h01/T1T2OFF/",
                        "UTC20211217/m12d17h01/T1T3Nolan/",
                        "UTC20211217/m12d17h01/T1T3OFF/",
                        "UTC20211217/m12d17h01/T1T4Nolan/",
                        "UTC20211217/m12d17h01/T1T4OFF/",
                        "UTC20211217/m12d17h01/T2T3Nolan/",
                        "UTC20211217/m12d17h01/T2T3OFF/",
                        "UTC20211217/m12d17h01/T2T4Nolan/",
                        "UTC20211217/m12d17h01/T2T4OFF/",
                        "UTC20211217/m12d17h01/T3T4Nolan/",
                        "UTC20211217/m12d17h01/T3T4OFF/",
                        "UTC20211217/m12d17h03/T0T1Nolan/",
                        "UTC20211217/m12d17h03/T1T2Nolan/",
                        "UTC20211217/m12d17h03/T1T2OFF/",
                        "UTC20211217/m12d17h03/T1T3Nolan/",
                        "UTC20211217/m12d17h03/T1T3OFF/",
                        "UTC20211217/m12d17h03/T1T4Nolan/",
                        "UTC20211217/m12d17h03/T1T4OFF/",
                        "UTC20211217/m12d17h03/T2T3Nolan/",
                        "UTC20211217/m12d17h03/T2T3OFF/",
                        "UTC20211217/m12d17h03/T2T4Nolan/",
                        "UTC20211217/m12d17h03/T2T4OFF/",
                        "UTC20211217/m12d17h03/T3T4Nolan/",
                        "UTC20211217/m12d17h03/T3T4OFF/",
                        "UTC20211217/m12d17h05/T0T1Nolan/",
                        "UTC20211217/m12d17h05/T1T2Nolan/",
                        "UTC20211217/m12d17h05/T1T2OFF/",
                        "UTC20211217/m12d17h05/T1T3Nolan/",
                        "UTC20211217/m12d17h05/T1T3OFF/",
                        "UTC20211217/m12d17h05/T1T4Nolan/",
                        "UTC20211217/m12d17h05/T1T4OFF/",
                        "UTC20211217/m12d17h05/T2T3Nolan/",
                        "UTC20211217/m12d17h05/T2T3OFF/",
                        "UTC20211217/m12d17h05/T2T4Nolan/",
                        "UTC20211217/m12d17h05/T2T4OFF/",
                        "UTC20211217/m12d17h05/T3T4Nolan/",
                        "UTC20211217/m12d17h05/T3T4OFF/",
                        "UTC20220212/m02d11h19/T1T2Nolan/",
                        "UTC20220212/m02d11h19/T1T2OFF/",
                        "UTC20220212/m02d11h19/T1T2OSU/",
                        "UTC20220212/m02d11h19/T1T3Nolan/",
                        "UTC20220212/m02d11h19/T1T3OFF/",
                        "UTC20220212/m02d11h19/T1T3OSU/",
                        "UTC20220212/m02d11h19/T1T4Nolan/",
                        "UTC20220212/m02d11h19/T1T4OFF/",
                        "UTC20220212/m02d11h19/T1T4OSU/",
                        "UTC20220212/m02d11h19/T2T3OSU/",
                        "UTC20220212/m02d11h19/T2T4Nolan/",
                        "UTC20220212/m02d11h19/T2T4OFF/",
                        "UTC20220212/m02d11h19/T2T4OSU/",
                        "UTC20220212/m02d11h19/T3T4Nolan/",
                        "UTC20220212/m02d11h19/T3T4OFF/",
                        "UTC20220212/m02d11h19/T3T4OSU/",
                        "UTC20220212/m02d11h20/T1T2Nolan/",
                        "UTC20220212/m02d11h20/T1T2OFF/",
                        "UTC20220212/m02d11h20/T1T2OSU/",
                        "UTC20220212/m02d11h20/T1T3Nolan/",
                        "UTC20220212/m02d11h20/T1T3OFF/",
                        "UTC20220212/m02d11h20/T1T3OSU/",
                        "UTC20220212/m02d11h20/T1T4Nolan/",
                        "UTC20220212/m02d11h20/T1T4OFF/",
                        "UTC20220212/m02d11h20/T1T4OSU/",
                        "UTC20220212/m02d11h20/T2T3OSU/",
                        "UTC20220212/m02d11h20/T2T4Nolan/",
                        "UTC20220212/m02d11h20/T2T4OFF/",
                        "UTC20220212/m02d11h20/T2T4OSU/",
                        "UTC20220212/m02d11h20/T3T4Nolan/",
                        "UTC20220212/m02d11h20/T3T4OFF/",
                        "UTC20220212/m02d11h20/T3T4OSU/",
                        "UTC20220212/m02d11h23/T1T2Nolan/",
                        "UTC20220212/m02d11h23/T1T2OFF/",
                        "UTC20220212/m02d11h23/T1T2OSU/",
                        "UTC20220212/m02d11h23/T1T3Nolan/",
                        "UTC20220212/m02d11h23/T1T3OFF/",
                        "UTC20220212/m02d11h23/T1T3OSU/",
                        "UTC20220212/m02d11h23/T1T4Nolan/",
                        "UTC20220212/m02d11h23/T1T4OFF/",
                        "UTC20220212/m02d11h23/T1T4OSU/",
                        "UTC20220212/m02d11h23/T2T3OSU/",
                        "UTC20220212/m02d11h23/T2T4Nolan/",
                        "UTC20220212/m02d11h23/T2T4OFF/",
                        "UTC20220212/m02d11h23/T2T4OSU/",
                        "UTC20220212/m02d11h23/T3T4Nolan/",
                        "UTC20220212/m02d11h23/T3T4OFF/",
                        "UTC20220212/m02d11h23/T3T4OSU/",
                        "UTC20220212/m02d12h01/T1T2Nolan/",
                        "UTC20220212/m02d12h01/T1T2OFF/",
                        "UTC20220212/m02d12h01/T1T2OSU/",
                        "UTC20220212/m02d12h01/T1T3Nolan/",
                        "UTC20220212/m02d12h01/T1T3OFF/",
                        "UTC20220212/m02d12h01/T1T3OSU/",
                        "UTC20220212/m02d12h01/T1T4Nolan/",
                        "UTC20220212/m02d12h01/T1T4OFF/",
                        "UTC20220212/m02d12h01/T1T4OSU/",
                        "UTC20220212/m02d12h01/T2T3OSU/",
                        "UTC20220212/m02d12h01/T2T4Nolan/",
                        "UTC20220212/m02d12h01/T2T4OFF/",
                        "UTC20220212/m02d12h01/T2T4OSU/",
                        "UTC20220212/m02d12h01/T3T4Nolan/",
                        "UTC20220212/m02d12h01/T3T4OFF/",
                        "UTC20220212/m02d12h01/T3T4OSU/",
                        "UTC20220212/m02d12h03/T1T2Nolan/",
                        "UTC20220212/m02d12h03/T1T2OFF/",
                        "UTC20220212/m02d12h03/T1T2OSU/",
                        "UTC20220212/m02d12h03/T1T3Nolan/",
                        "UTC20220212/m02d12h03/T1T3OFF/",
                        "UTC20220212/m02d12h03/T1T3OSU/",
                        "UTC20220212/m02d12h03/T1T4Nolan/",
                        "UTC20220212/m02d12h03/T1T4OFF/",
                        "UTC20220212/m02d12h03/T1T4OSU/",
                        "UTC20220212/m02d12h03/T2T3OSU/",
                        "UTC20220212/m02d12h03/T2T4Nolan/",
                        "UTC20220212/m02d12h03/T2T4OFF/",
                        "UTC20220212/m02d12h03/T2T4OSU/",
                        "UTC20220212/m02d12h03/T3T4Nolan/",
                        "UTC20220212/m02d12h03/T3T4OFF/",
                        "UTC20220212/m02d12h03/T3T4OSU/",
                        "UTC20220214/m02d13h19/T1T2Nolan/",
                        "UTC20220214/m02d13h19/T1T2OFF/",
                        "UTC20220214/m02d13h19/T1T2OSU/",
                        "UTC20220214/m02d13h19/T1T3Nolan/",
                        "UTC20220214/m02d13h19/T1T3OFF/",
                        "UTC20220214/m02d13h19/T1T3OSU/",
                        "UTC20220214/m02d13h19/T1T4Nolan/",
                        "UTC20220214/m02d13h19/T1T4OFF/",
                        "UTC20220214/m02d13h19/T1T4OSU/",
                        "UTC20220214/m02d13h19/T2T3OSU/",
                        "UTC20220214/m02d13h19/T2T4Nolan/",
                        "UTC20220214/m02d13h19/T2T4OFF/",
                        "UTC20220214/m02d13h19/T3T4Nolan/",
                        "UTC20220214/m02d13h19/T3T4OFF/",
                        "UTC20220214/m02d13h21/T1T2Nolan/",
                        "UTC20220214/m02d13h21/T1T2OFF/",
                        "UTC20220214/m02d13h21/T1T3Nolan/",
                        "UTC20220214/m02d13h21/T1T3OFF/",
                        "UTC20220214/m02d13h21/T1T3OSU/",
                        "UTC20220214/m02d13h21/T1T4Nolan/",
                        "UTC20220214/m02d13h21/T1T4OFF/",
                        "UTC20220214/m02d13h21/T2T3OSU/",
                        "UTC20220214/m02d13h21/T2T4Nolan/",
                        "UTC20220214/m02d13h21/T2T4OFF/",
                        "UTC20220214/m02d13h21/T3T4Nolan/",
                        "UTC20220214/m02d13h21/T3T4OFF/",
                        "UTC20220214/m02d13h23/T1T2Nolan/",
                        "UTC20220214/m02d13h23/T1T2OFF/",
                        "UTC20220214/m02d13h23/T1T3Nolan/",
                        "UTC20220214/m02d13h23/T1T3OFF/",
                        "UTC20220214/m02d13h23/T1T4Nolan/",
                        "UTC20220214/m02d13h23/T1T4OFF/",
                        "UTC20220214/m02d13h23/T2T3OSU/",
                        "UTC20220214/m02d13h23/T2T4Nolan/",
                        "UTC20220214/m02d13h23/T2T4OFF/",
                        "UTC20220214/m02d13h23/T3T4Nolan/",
                        "UTC20220214/m02d13h23/T3T4OFF/",
                        "UTC20220214/m02d14h01/T1T2Nolan/",
                        "UTC20220214/m02d14h01/T1T2OFF/",
                        "UTC20220214/m02d14h01/T1T3Nolan/",
                        "UTC20220214/m02d14h01/T1T3OFF/",
                        "UTC20220214/m02d14h01/T1T4Nolan/",
                        "UTC20220214/m02d14h01/T1T4OFF/",
                        "UTC20220214/m02d14h01/T2T3OSU/",
                        "UTC20220214/m02d14h01/T2T4Nolan/",
                        "UTC20220214/m02d14h01/T2T4OFF/",
                        "UTC20220214/m02d14h01/T3T4Nolan/",
                        "UTC20220214/m02d14h01/T3T4OFF/",
                        "UTC20220214/m02d14h03/T1T2Nolan/",
                        "UTC20220214/m02d14h03/T1T2OFF/",
                        "UTC20220214/m02d14h03/T1T3Nolan/",
                        "UTC20220214/m02d14h03/T1T3OFF/",
                        "UTC20220214/m02d14h03/T1T4Nolan/",
                        "UTC20220214/m02d14h03/T1T4OFF/",
                        "UTC20220214/m02d14h03/T2T3OSU/",
                        "UTC20220214/m02d14h03/T2T4Nolan/",
                        "UTC20220214/m02d14h03/T2T4OFF/",
                        "UTC20220214/m02d14h03/T3T4Nolan/",
                        "UTC20220214/m02d14h03/T3T4OFF/",
                        "UTC20220313/m03d12h22/T1T2Nolan/",
                        "UTC20220313/m03d12h22/T1T2OFF/",
                        "UTC20220313/m03d12h22/T1T2OSU/",
                        "UTC20220313/m03d12h22/T1T3Nolan/",
                        "UTC20220313/m03d12h22/T1T3OFF/",
                        "UTC20220313/m03d12h22/T1T3OSU/",
                        "UTC20220313/m03d12h22/T1T4Nolan/",
                        "UTC20220313/m03d12h22/T1T4OFF/",
                        "UTC20220313/m03d12h22/T1T4OSU/",
                        "UTC20220313/m03d12h22/T2T3Nolan/",
                        "UTC20220313/m03d12h22/T2T3OFF/",
                        "UTC20220313/m03d12h22/T2T3OSU/",
                        "UTC20220313/m03d12h22/T2T4Nolan/",
                        "UTC20220313/m03d12h22/T2T4OFF/",
                        "UTC20220313/m03d12h22/T2T4OSU/",
                        "UTC20220313/m03d12h22/T3T4Nolan/",
                        "UTC20220313/m03d12h22/T3T4OFF/",
                        "UTC20220313/m03d12h22/T3T4OSU/",
                        "UTC20220313/m03d13h01/T1T2Nolan/",
                        "UTC20220313/m03d13h01/T1T2OFF/",
                        "UTC20220313/m03d13h01/T1T2OSU/",
                        "UTC20220313/m03d13h01/T1T3Nolan/",
                        "UTC20220313/m03d13h01/T1T3OFF/",
                        "UTC20220313/m03d13h01/T1T3OSU/",
                        "UTC20220313/m03d13h01/T1T4Nolan/",
                        "UTC20220313/m03d13h01/T1T4OFF/",
                        "UTC20220313/m03d13h01/T1T4OSU/",
                        "UTC20220313/m03d13h01/T2T3Nolan/",
                        "UTC20220313/m03d13h01/T2T3OFF/",
                        "UTC20220313/m03d13h01/T2T3OSU/",
                        "UTC20220313/m03d13h01/T2T4Nolan/",
                        "UTC20220313/m03d13h01/T2T4OFF/",
                        "UTC20220313/m03d13h01/T2T4OSU/",
                        "UTC20220313/m03d13h01/T3T4Nolan/",
                        "UTC20220313/m03d13h01/T3T4OFF/",
                        "UTC20220313/m03d13h01/T3T4OSU/",
                        "UTC20220511/m05d10h21/T1T2OFF/",
                        "UTC20220511/m05d10h21/T1T3OFF/",
                        "UTC20220511/m05d10h21/T1T4OFF/",
                        "UTC20220511/m05d10h21/T2T3OFF/"};

noisey->Print("Simulation.pdf[");
  for (int j=0; j<npath; j++){
    TProfile* origHBTpeak;
    TFile *CorrelationFile = new TFile("/fs/ess/PAS1977/StellarAnalysis/betUMa/"+Dir[j]+"Analysis.root","READONLY"); // must add the strings
    CorrelationFile->GetObject("HBTPeakWithFit",origHBTpeak);
  //origHBTpeak->Draw();
    TH1D* noise1 = new TH1D("noise1","noise",TauWindowWidth,0-0.5*TauWindowWidth,0+0.5*TauWindowWidth);  // <!> ADD FOR MORE 20 NS CHUNKS <!>
    for (int i=0; i<TauWindowWidth; i++){
      noise1->SetBinContent(i,origHBTpeak->GetBinContent(i) + Amp*exp(-(pow((noise1->GetXaxis()->GetBinCenter(i)-Shift)/Sigma,2)/2.0)));
      noise1->SetBinError(i,origHBTpeak->GetBinError(i));
    }
    //noisey->cd(j+1);
    noise1->Draw();
     noisey->Print("Simulation.pdf");
  }

  noisey->Print("Simulation.pdf]");

  //CFsim->SetBinContent(j,tr->Gaus(0.0,Sigma) + signalAmp*exp(-(pow((CFsim->GetXaxis()->GetBinCenter(j)-signalPos)/signalSig,2)/2.0)));

}
